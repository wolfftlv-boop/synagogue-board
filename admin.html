<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>× ×™×”×•×œ ×—×–×•×Ÿ ××œ×™×”×•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .panel { display: none; }
        .panel.active { display: block; }
        .tab.active { background: #d97706; color: white; border-bottom: 4px solid #92400e; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen">
    
    <div id="login-form" class="max-w-md mx-auto bg-white p-8 rounded-2xl shadow-xl mt-20">
        <h2 class="text-3xl font-bold mb-6 text-center">×›× ×™×¡×ª ×× ×”×œ</h2>
        <input type="email" id="email" placeholder="××™××™×™×œ" class="w-full p-4 mb-4 border rounded-xl">
        <input type="password" id="pass" placeholder="×¡×™×¡××”" class="w-full p-4 mb-6 border rounded-xl">
        <button id="login-btn" class="w-full bg-slate-800 text-white p-4 rounded-xl font-bold">×”×ª×—×‘×¨×•×ª</button>
    </div>

    <div id="admin-content" class="hidden max-w-5xl mx-auto p-4">
        <header class="bg-amber-600 p-6 rounded-t-2xl text-white flex justify-between items-center">
            <h1 class="text-2xl font-bold">×œ×•×— ×‘×§×¨×” - ×™×©×™×‘×ª ×—×–×•×Ÿ ××œ×™×”×•</h1>
            <button onclick="location.reload()" class="text-sm bg-amber-800 px-3 py-1 rounded">×™×¦×™××”</button>
        </header>

        <nav class="flex bg-white border-b overflow-x-auto">
            <button onclick="tab(0)" class="tab active flex-1 p-5 font-bold">âš™ï¸ ×”×’×“×¨×•×ª</button>
            <button onclick="tab(1)" class="tab flex-1 p-5 font-bold">ğŸ• ×ª×¤×™×œ×•×ª</button>
            <button onclick="tab(2)" class="tab flex-1 p-5 font-bold">ğŸ“¢ ×”×•×“×¢×•×ª</button>
            <button onclick="tab(3)" class="tab flex-1 p-5 font-bold">ğŸ•¯ï¸ ×”×§×“×©×•×ª</button>
        </nav>

        <main class="bg-white p-8 rounded-b-2xl shadow-lg">
            <div id="p0" class="panel active">
                <h3 class="text-xl font-bold mb-4">×”×’×“×¨×•×ª ×ª×¦×•×’×”</h3>
                <label>×©× ×”×™×©×™×‘×”:</label>
                <input type="text" id="set-name" class="w-full p-3 border mb-4 rounded-lg">
                <label>×˜×§×¡×˜ ×¨×¥ ×‘×ª×—×ª×™×ª:</label>
                <textarea id="set-ticker" class="w-full p-3 border mb-4 rounded-lg h-24"></textarea>
                <button onclick="saveSettings()" class="bg-amber-600 text-white px-8 py-3 rounded-lg font-bold w-full">×©××•×¨ ×”×›×œ</button>
            </div>

            <div id="p1" class="panel">
                <h3 class="text-xl font-bold mb-4">×”×•×¡×¤×ª ×ª×¤×™×œ×” / ×©×™×¢×•×¨</h3>
                <div class="flex gap-2">
                    <input type="text" id="pr-name" placeholder="×©× (×œ××©×œ: ×× ×—×” ×‘')" class="flex-1 p-3 border rounded-lg">
                    <input type="text" id="pr-time" placeholder="×©×¢×”" class="w-32 p-3 border rounded-lg">
                    <button onclick="add('prayers', {name:$('#pr-name').value, time:$('#pr-time').value})" class="bg-green-600 text-white px-8 rounded-lg font-bold">+</button>
                </div>
                <div id="list-prayers" class="mt-8 space-y-2"></div>
            </div>

            <div id="p2" class="panel">
                <h3 class="text-xl font-bold mb-4">×”×•×“×¢×•×ª ×¨×’×™×œ×•×ª</h3>
                <div class="flex gap-2">
                    <input type="text" id="msg-text" placeholder="×ª×•×›×Ÿ ×”×”×•×“×¢×”" class="flex-1 p-3 border rounded-lg">
                    <button onclick="add('messages', {text:$('#msg-text').value})" class="bg-green-600 text-white px-8 rounded-lg font-bold">+</button>
                </div>
                <div id="list-messages" class="mt-8 space-y-2"></div>
            </div>

            <div id="p3" class="panel">
                <h3 class="text-xl font-bold mb-4">×”×§×“×©×•×ª ×œ×œ×™××•×“</h3>
                <div class="flex gap-2">
                    <input type="text" id="ded-text" placeholder="×œ××©×œ: ×œ×–×›×•×ª ×¨×¤×•××ª ×™×¦×—×§ ×‘×Ÿ ×©×¨×”" class="flex-1 p-3 border rounded-lg">
                    <button onclick="add('dedications', {text:$('#ded-text').value})" class="bg-green-600 text-white px-8 rounded-lg font-bold">+</button>
                </div>
                <div id="list-dedications" class="mt-8 space-y-2"></div>
            </div>
        </main>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script>
        const firebaseConfig = { /* ××•×ª×• ×§×•× ×¤×™×’ ×›××• ×‘-script.js */ };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();

        const $ = id => document.querySelector(id);
        
        $('#login-btn').onclick = () => {
            auth.signInWithEmailAndPassword($('#email').value, $('#pass').value)
                .then(() => { $('#login-form').style.display='none'; $('#admin-content').style.display='block'; })
                .catch(() => alert("×˜×¢×•×ª ×‘×¤×¨×˜×™×"));
        };

        window.tab = (i) => {
            document.querySelectorAll('.tab, .panel').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab')[i].classList.add('active');
            $(`#p${i}`).classList.add('active');
        };

        window.saveSettings = () => {
            db.collection("settings").doc("global").set({
                shul_name: $('#set-name').value,
                ticker: $('#set-ticker').value
            }).then(() => alert("× ×©××¨!"));
        };

        window.add = (col, data) => {
            if(!data.name && !data.text) return;
            db.collection(col).add(data);
            $(`#${col.slice(0,-1)}-name`) ? $(`#${col.slice(0,-1)}-name`).value = '' : null;
            $(`#${col.slice(0,-1)}-text`) ? $(`#${col.slice(0,-1)}-text`).value = '' : null;
        };

        const syncAdmin = (col) => {
            db.collection(col).onSnapshot(snap => {
                let html = '';
                snap.forEach(doc => {
                    const d = doc.data();
                    html += `<div class="flex justify-between p-3 bg-slate-50 rounded mb-2 border">
                        <span>${d.name || ''} ${d.time || ''} ${d.text || ''}</span>
                        <button onclick="db.collection('${col}').doc('${doc.id}').delete()" class="text-red-600 font-bold">××—×§</button>
                    </div>`;
                });
                $(`#list-${col}`).innerHTML = html;
            });
        };
        ["prayers", "messages", "dedications"].forEach(syncAdmin);
    </script>
</body>
</html>