<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>× ×™×”×•×œ ×—×–×•×Ÿ ××œ×™×”×•</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-btn.active { background: #d97706; color: white; }
    </style>
</head>
<body class="bg-slate-100 min-h-screen p-4">
    <div id="login-form" class="max-w-md mx-auto bg-white p-8 rounded-2xl shadow-xl mt-20">
        <h2 class="text-2xl font-bold mb-6 text-center">×›× ×™×¡×ª ×× ×”×œ</h2>
        <input type="email" id="email" placeholder="××™××™×™×œ" class="w-full p-4 mb-4 border rounded-xl">
        <input type="password" id="pass" placeholder="×¡×™×¡××”" class="w-full p-4 mb-6 border rounded-xl">
        <button onclick="login()" class="w-full bg-slate-800 text-white p-4 rounded-xl font-bold">×”×ª×—×‘×¨×•×ª</button>
    </div>

    <div id="admin-panel" class="hidden max-w-5xl mx-auto">
        <nav class="flex gap-2 mb-6 overflow-x-auto bg-white p-2 rounded-xl shadow">
            <button onclick="showTab('settings')" class="tab-btn active p-4 rounded-lg font-bold flex-1">âš™ï¸ ×”×’×“×¨×•×ª</button>
            <button onclick="showTab('prayers')" class="tab-btn p-4 rounded-lg font-bold flex-1">ğŸ• ×ª×¤×™×œ×•×ª</button>
            <button onclick="showTab('schedule')" class="tab-btn p-4 rounded-lg font-bold flex-1">ğŸ“… ×¡×“×¨ ×™×•×</button>
            <button onclick="showTab('messages')" class="tab-btn p-4 rounded-lg font-bold flex-1">ğŸ“¢ ××•×“×¢×•×ª</button>
            <button onclick="showTab('dedications')" class="tab-btn p-4 rounded-lg font-bold flex-1">ğŸ•¯ï¸ ×”×§×“×©×•×ª</button>
        </nav>

        <div class="bg-white p-8 rounded-2xl shadow-lg">
            <!-- Settings -->
            <div id="settings" class="tab-content active">
                <h3 class="text-xl font-bold mb-4">×”×’×“×¨×•×ª ×›×œ×œ×™×•×ª</h3>
                <label class="block mb-2">×©× ×”××•×¡×“:</label>
                <input type="text" id="set-name" class="w-full p-3 border rounded-lg mb-4">
                <label class="block mb-2">×˜×§×¡×˜ ×¨×¥ (Ticker):</label>
                <textarea id="set-ticker" class="w-full p-3 border rounded-lg mb-4 h-24"></textarea>
                <button onclick="saveGlobal()" class="w-full bg-amber-600 text-white p-4 rounded-xl font-bold">×©××•×¨ ×”×›×œ</button>
            </div>

            <!-- Schedule -->
            <div id="schedule" class="tab-content">
                <h3 class="text-xl font-bold mb-4">× ×™×”×•×œ ×¡×“×¨ ×™×•×</h3>
                <div class="grid grid-cols-2 gap-4 mb-4">
                    <select id="sc-day" class="p-3 border rounded-lg">
                        <option value="0">×™×•× ×¨××©×•×Ÿ</option><option value="1">×™×•× ×©× ×™</option>
                        <option value="2">×™×•× ×©×œ×™×©×™</option><option value="3">×™×•× ×¨×‘×™×¢×™</option>
                        <option value="4">×™×•× ×—××™×©×™</option><option value="5">×™×•× ×©×™×©×™</option>
                        <option value="6">×™×•× ×©×‘×ª</option>
                    </select>
                    <input type="text" id="sc-time" placeholder="×©×¢×•×ª" class="p-3 border rounded-lg">
                </div>
                <input type="text" id="sc-act" placeholder="×¤×¢×™×œ×•×ª" class="w-full p-3 border rounded-lg mb-4">
                <button onclick="addItem('schedule', {day: document.getElementById('sc-day').value, time: document.getElementById('sc-time').value, act: document.getElementById('sc-act').value})" class="w-full bg-blue-600 text-white p-3 rounded-lg font-bold">×”×•×¡×£ ×œ×¡×“×¨ ×™×•×</button>
                <div id="list-schedule" class="mt-6 space-y-2"></div>
            </div>

            <!-- Others (Prayers, Messages, Deds) -->
             <div id="prayers" class="tab-content">
                <h3 class="text-xl font-bold mb-4">×ª×¤×™×œ×•×ª</h3>
                <div class="flex gap-2 mb-4">
                    <input type="text" id="pr-name" placeholder="×©×" class="flex-1 p-3 border rounded-lg">
                    <input type="text" id="pr-time" placeholder="×©×¢×”" class="w-24 p-3 border rounded-lg">
                    <button onclick="addItem('prayers', {name: document.getElementById('pr-name').value, time: document.getElementById('pr-time').value})" class="bg-green-600 text-white px-6 rounded-lg font-bold">+</button>
                </div>
                <div id="list-prayers" class="space-y-2"></div>
            </div>
            <!-- ... ×©××¨ ×”×˜××‘×™× ×“×•××™× ... -->
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script>
        const firebaseConfig = { apiKey: "AIzaSyDe31VHniTkz_grYpA2e_RXx4g5Cnxa1ng", authDomain: "synagogue-board-tlv.firebaseapp.com", projectId: "synagogue-board-tlv" };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        function login() {
            firebase.auth().signInWithEmailAndPassword(document.getElementById('email').value, document.getElementById('pass').value)
                .then(() => { document.getElementById('login-form').classList.add('hidden'); document.getElementById('admin-panel').classList.remove('hidden'); initSync(); })
                .catch(() => alert("×©×’×™××”"));
        }

        function showTab(id) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList.add('active');
        }

        function saveGlobal() {
            db.collection("settings").doc("global").set({ shul_name: document.getElementById('set-name').value, ticker: document.getElementById('set-ticker').value }, {merge: true});
        }

        function addItem(col, data) {
            db.collection(col).add(data);
        }

        function initSync() {
            const cols = ['prayers', 'schedule', 'messages', 'dedications'];
            cols.forEach(col => {
                db.collection(col).onSnapshot(snap => {
                    let html = '';
                    snap.forEach(doc => {
                        const d = doc.data();
                        html += `<div class="flex justify-between p-3 bg-slate-50 border rounded-lg">
                            <span>${d.day ? '×™×•× ' + d.day + ' | ' : ''} ${d.name || d.act || d.text} ${d.time || ''}</span>
                            <button onclick="firebase.firestore().collection('${col}').doc('${doc.id}').delete()" class="text-red-600">××—×§</button>
                        </div>`;
                    });
                    const listEl = document.getElementById('list-' + col);
                    if(listEl) listEl.innerHTML = html;
                });
            });
        }
    </script>
</body>
</html>
